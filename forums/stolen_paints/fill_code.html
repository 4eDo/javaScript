<!DOCTYPE html>
<html>
<head>
<title>Форма</title>
</head>
<body>

<p>User: <input type="text" id="uname" /></p>
<p>PicId: <input type="number" min="0" max="7" id="picId"/></p>
<p>Count: <input type="number" min="1" id="count" /></p>
<p>pigm: <input type="number" min="0" id="pigm"  step="0.5"/></p>
<p>selColor: <select id="color">
	<option value="none">none</option>
	<option value="red">red</option>
	<option value="green">green</option>
	<option value="blue">blue</option>
	<option value="black">black</option>
	<option value="white">white</option>
	<option value="pale">pale</option>
	<option value="vivid">vivid</option>
</select></p>
<p>Red: <input type="number"  id="red" step="0.5"/></p>
<p>Green: <input type="number"  id="green" step="0.5"/></p>
<p>Blue: <input type="number"  id="blue" step="0.5"/></p>
<p>Black: <input type="number"  id="black" step="0.5"/></p>
<p>White: <input type="number"  id="white" step="0.5"/></p>
<p>Pale: <input type="number"  id="pale" step="0.5"/></p>
<p>Vivid: <input type="number"  id="vivid" step="0.5"/></p>

<button id="getLinkBtn">Получить ссылку</button>
<button id="loadCodeBtn">Загрузить код</button>

<textarea id="outputText" readonly placeholder="Результат будет здесь..."></textarea>

<script>
  const getLinkBtn = document.getElementById('getLinkBtn');
  const loadCodeBtn = document.getElementById('loadCodeBtn');
  const outputText = document.getElementById('outputText');

  getLinkBtn.addEventListener('click', () => {
    const urlParams = new URLSearchParams(window.location.search);
    const user = document.getElementById('uname').value;
    const picId = document.getElementById('picId').value;
    const count = document.getElementById('count').value;
    const pigm = document.getElementById('pigm').value;
    const color = document.getElementById('color').value;
    const red = document.getElementById('red').value;
    const green = document.getElementById('green').value;
    const blue = document.getElementById('blue').value;
    const black = document.getElementById('black').value;
    const white = document.getElementById('white').value;
    const pale = document.getElementById('pale').value;
    const vivid = document.getElementById('vivid').value;

    if (user) urlParams.set('user', user);
    if (picId) urlParams.set('picId', picId);
    if (count) urlParams.set('count', count);
    if (pigm) urlParams.set('pigm', pigm);
    if (color) urlParams.set('color', color);
    if (red) urlParams.set('red', red);
    if (green) urlParams.set('green', green);
    if (blue) urlParams.set('blue', blue);
    if (black) urlParams.set('black', black);
    if (white) urlParams.set('white', white);
    if (pale) urlParams.set('pale', pale);
    if (vivid) urlParams.set('vivid', vivid);

    const newUrl = `${window.location.origin}${window.location.pathname}?${urlParams.toString()}`;
    outputText.value = newUrl;
  });

  loadCodeBtn.addEventListener('click', () => {
    const urlParams = new URLSearchParams(window.location.search);
    const user = urlParams.get('user') || 0;
    const picId = urlParams.get('picId') || 0;
    const count = urlParams.get('count') || 1;
    const pigm = urlParams.get('pigm') || 0;
    const color = urlParams.get('color') || "none";
    let red = urlParams.get('red') || 0;
    let green = urlParams.get('green') || 0;
    let blue = urlParams.get('blue') || 0;
    let black = urlParams.get('black') || 0;
    let white = urlParams.get('white') || 0;
    let pale = urlParams.get('pale') || 0;
    let vivid = urlParams.get('vivid') || 0;

    document.getElementById('uname').value = user;
    document.getElementById('picId').value = picId;
    document.getElementById('count').value = count;
    document.getElementById('pigm').value = pigm;
    document.getElementById('color').value = color;
    document.getElementById('red').value = red;
    document.getElementById('green').value = green;
    document.getElementById('blue').value = blue;
    document.getElementById('black').value = black;
    document.getElementById('white').value = white;
    document.getElementById('pale').value = pale;
    document.getElementById('vivid').value = vivid;

    if (count > 1) {
      red *= count;
      green *= count;
      blue *= count;
      black *= count;
      white *= count;
      pale *= count;
      vivid *= count;
    }

    if (!red && !green && !blue && !black && !white && !pale && !vivid) {
      if (color === "none") {
        const colors = ["red", "green", "blue", "black", "white", "pale", "vivid"];
        const randomColor = colors[Math.floor(Math.random() * colors.length)];
        document.getElementById(randomColor).value = pigm;
      } else {
        document.getElementById(color).value = pigm;
      }
    }

    const outputText = `
    {
        "user": "${user}",
        "picId": "${picId}",
        "red": "${red}",
        "green": "${green}",
        "blue": "${blue}",
        "white": "${white}",
        "black": "${black}",
        "pale": "${pale}",
        "vivid": "${vivid}"
      },`;

    outputText.value = outputText;
  });
</script>
</body>
</html>
